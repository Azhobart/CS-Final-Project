<!DOCTYPE html>

<html>
  <head>
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.cdnfonts.com/css/galactic-storm" rel="stylesheet">

  </head>
  <body class="container">
    <div id="app">
      <nav id="titleNav">
        <h1>Online Arcade</h1>
      </nav>
      <nav id="subNav"
        v-if="page != 'login' && page != 'register' && page != 'authentication'"
      >
        <h4>Welcome: {{currentUser.username}}</h4>

        <div>
          <button @click="setPage('home')">Games</button>
          <button @click="setPage('leaderboard')">Leaderboard</button>
          <button @click="setPage('profile')">Profile</button>
        </div>

      </nav>

      <!-- log-in page (Username Field) -->
      <div id="loginField" v-if="page === 'login'">
        <div class="sectionContainer">
          <h3 class="title">Login:</h3>
          <div class="inputContainer">
            <p>Username:</p>
            <input v-model="this.user.username" />
          </div>
          <div class="inputContainer">
            <button @click="setPage('authentication'); getUserByUsername()">
              Next
            </button>
            <p class="accountMessage">
              Don't have an account?
              <span @click="setPage('register')">Sign-up!</span>
            </p>
          </div>
        </div>
        
      </div>

      <!-- log-in page (Authentication Field) -->
      <div id="authField" v-if="page === 'authentication'">
        <div class="sectionContainer">
          <h3 class="title">Authentication:</h3>
          <div class="inputContainer">
            <p>{{this.user.authQuestion}}</p>
            <input v-model="user.authAnswer" />
          </div>
          <div class="inputContainer">
            <button @click="loginUser()">Login</button>
          </div>
        </div>
        </form>
      </div>

      <!-- register page -->
      <div id="registerField" v-show="page === 'register'">
        <div class="sectionContainer">
          <h3 class="title">Register:</h3>
          <!-- name -->
          <div class="inputContainer">
            <p>Name:</p>
            <input v-model="user.name"/>
          </div>
          <!-- username -->
          <div class="inputContainer">
            <p>Username:</p>
            <input v-model="user.username"/>
          </div>
          <!-- authentication question -->
          <div class="inputContainer">
            <p>Authentication Question:</p>
            <input v-model="user.authQuestion"/>
          </div>
          <!-- authentication answer -->
          <div class="inputContainer">
            <p>Authentication Answer:</p>
            <input v-model="user.authAnswer"/>
          </div>
          <!-- user region -->
          <div class="inputContainer">
            <p>Region:</p>
            <input v-model="user.region"/>
          </div>
          <!-- submit -->
          <div class="inputContainer">
            <button @click="setPage('login'); registerUser()">Register</button>
            <p class="accountMessage">
              Already have an account?
              <span @click="setPage('login');">Login!</span>
            </p>
          </div>
        </div>
      </div>



      <!-- home/game page -->
      <div class="page" v-if="page === 'home'">
        <div class="sectionContainer">
          <div class="column">
            <div class="inputContainer row searchInput">
              <input placeholder="Search..." />
              <button>Search</button>
            </div>
            <div class="gameListDiv">
              <div class="row" v-for="(game, index) in games">
                <div class="gameThumbnail column" @click="setPage(game.name)">
                  <div
                    v-bind:style="{backgroundImage: 'url(' + game.image + ')'}"
                  ></div>
                  <p>{{ game.name }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div v-if="page === 'profile'">
        <div class="sectionContainer">
          <h1 class="title">{{currentUser.username}}'s Profile</h1>
          <h2 class="userTitle">User Data:</h2>
          <div class="profileData">


            <p>Name:</p> <input placeholder="name" v-show="isEditing" v-model="currentUser.name">
            <span v-show="!isEditing">{{ currentUser.name }}</span>

            <p>Username:</p> <input placeholder="username" v-show="isEditing" v-model="currentUser.username">
            <span v-show="!isEditing">{{ currentUser.username }}</span>

            <p>Region:</p> <input placeholder="region" v-show="isEditing" v-model="currentUser.region">
            <span v-show="!isEditing">{{ currentUser.region }}</span>

            <p>Authentication Question:</p> <input placeholder="question" v-show="isEditing" v-model="currentUser.authQuestion">
            <span v-show="!isEditing">{{ currentUser.authQuestion }}</span>

            <p>Authentication Answer:</p> <input placeholder="answer" v-show="isEditing" v-model="currentUser.authAnswer">
            <span v-show="!isEditing">{{ currentUser.authAnswer }}</span>


          </div>
          <h2 class="userTitle">Game Data:</h2>
          <div class="profileData">
            <p>Favorite Game:</p> <input placeholder="favorite game" v-show="isEditing" v-model="currentUser.favoriteGame">
            <span v-show="!isEditing">{{ currentUser.favoriteGame }}</span>

            <p>Highscores:</p>
            <div class="scoreTableRow" v-for="(score, indx) in currentUser.scores">
              <p>{{score.value}}</p>
              <p>{{score.game}}</p>
            </div>
          </div>
          <div id="profileActions">
            <button @click="editProfile()">Edit</button>
            <button v-if="isEditing" @click="saveProfile()">Save</button>
            <button @click="deleteSession()">Logout</button>
          </div>

  
        </div>
      </div>


      <div class="page" v-if="page === 'leaderboard'">
        <div class="sectionContainer">
          <div class="column">
            <div class="inputContainer row searchInput">
              <input placeholder="Search..." v-model="scoreUserSearchInput"/>

              <select v-model="scoreGameSearchInput">
                <option v-for="game in games" :value="game.name">{{game.name}}</option>
              </select>
              <select v-model="scoreRegionSearchInput" >
                <option value="" selected>Any</option>
                <option v-for="region in regions" :value="region.code ">{{region.code}} - {{region.name}}</option>
              </select>
            </div>

            <div class="scoreTableRow" v-for="(score, indx) in filteredScores">
              <p>{{indx}}.</p>
              <p>{{score.user.username}}</p>
              <p>{{score.value}}</p>
              <p>{{score.game}}</p>
              <p>{{score.user.region}}</p>
            </div>
          </div>
        </div>
      </div>

      <div class="page" v-if="page === 'finished game'">
        <div class="sectionContainer">
          <h1>Good Game!</h1>
          <p>{{lastAchievedScore.game}}</p>
          <p>{{lastAchievedScore.value}}</p>

          <button @click="setPage('home'); setScore(lastAchievedScore)">Back To Home</button>
        </div>
      </div>

      <!-- prisoners dilemma game -->
      <div class="page" v-if="page === 'Prisoner\'s Dilemma'">
        <div class="sectionContainer">
          <div class="row">
            <p>Play Against</p>
            <select v-model="prisonBot">
              <option value="Random">Random</option>
              <option value="All Defects">All Defects</option>
              <option value="All Cooperations">All Cooperations</option>
              <option value="Tit For Tat">Tit For Tat</option>
            </select>
          </div>
          <div class="row">
            <p>Number Of Rounds</p>
            <input type="Number" v-model="prisonerGameLength">
          </div>
          <p>Your Score: {{prisonerScores[0]}}</p>
          <div class="row">
            <button @click="incrementPrisonerTurn(0)">Cooperate</button>
            <button @click="incrementPrisonerTurn(1)">Defect</button>
          </div>
          <br>
          <div class="prisonerHistoryGrid">
           
            <p>{{prisonerScores[0]}}</p>
            <p>You</p>
            <p>Opponent</p>
            <p>{{prisonerScores[1]}}</p>
          </div>
          <div class="prisonerHistoryGrid" v-for="el in prisonHistory">
            <p>{{el.scores[0]}}</p>
            <div class="prisonerChoiceDiv" :style="[el.choices[0] === 1 ? {backgroundColor: '#f00'} : {backgroundColor: '#0f0'}]"></div>
            <div class="prisonerChoiceDiv" :style="[el.choices[1] === 1 ? {backgroundColor: '#f00'} : {backgroundColor: '#0f0'}]"></div>
            <p>{{el.scores[1]}}</p>
          </div>
        </div>
      </div>

      <div class="page" v-if="page === 'Minesweeper'">
        <div class="sectionContainer">
          <div class="row">
            <p>Score: {{minesweeperScore}}</p>
            <button @click="beginMinesweeperGame()">Retry</button>
            <p>Mine Chance: 1/</p>
            <input type="number" v-model="minesweeperMineChance">
            <button @click="minesweeperMineChance = 8;">reset</button>
          </div oncontextmenu="return false;">
            <div class="minesweeperGridRow" v-for="(row, indx_x) in minesweeperBoard.cells">
              <div class="minesweeperCell" v-for="(cell, indx_y) in row" :style="[cell.isHidden ? {backgroundColor: '#aaa'} : {backgroundColor: '#ddd'}]" v-on:click.right="toggleFlagMinesweeperCell(indx_x,indx_y)" @click.left="unhideMinesweeperCell(indx_x,indx_y)" oncontextmenu="return false;">
                <div v-if="!cell.isHidden">
                  <div v-if="!cell.isMine">
                    {{cell.value}}
                  </div>
                  <div v-else>
                    <img width="40px" height="40px" src="https://jaumesegarra.github.io/minesweeper/favicon.ico" alt="!">
                  </div>
                </div>
                <div v-if="cell.isHidden && cell.isFlagged">
                  <img width="40px" height="40px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Flag_icon_orange_4.svg/729px-Flag_icon_orange_4.svg.png" alt="f">
                </div>
              </div>
            </div>
        </div>

        <div class="sectionContainer minesweeperModal" v-if="minesweeperGameState != 'playing'">
          <p>You Lose!</p>
          <div class="row" v-if="minesweeperGameState === 'lost'">
            
            <button @click="beginMinesweeperGame()">Play Again</button>
            <button @click="setPage('home'); beginMinesweeperGame()">Home</button>
          </div>
        </div>
      </div>

        <!-- colors game -->
      
        
      <div v-if="page === 'Colors'">
        
        <div id="colorWrapper">
          
          <div v-if="!colorGameOver" id="colorField" v-bind:style="{ backgroundColor: randomColor }">
            <div id="colorStart" v-if="!colorGameStart" @click="getColor(); cycleColors()">Start Game</div>
          </div>
        </div>
        
      

        

        <div id="inputField" v-if="!colorGameOver">
            <div v-bind:style="{ backgroundColor: '#FF0000' }" @click="addInput('#FF0000'); checkInput();">Red</div>
            <div v-bind:style="{ backgroundColor: '#0000FF' }" @click="addInput('#0000FF'); checkInput();">Blue</div>
            <div v-bind:style="{ backgroundColor: '#FFFF00' }" @click="addInput('#FFFF00'); checkInput();">Yellow</div>
            <div v-bind:style="{ backgroundColor: '#00FF00' }" @click="addInput('#00FF00'); checkInput();">Green</div>
        </div>

        <div v-if="colorGameOver">
            <p>Game Over | Score: {{ finalColorsScore }}</p>
        </div>
      </div>

    </div>
    <script src="app.js"></script>
  </body>
</html>